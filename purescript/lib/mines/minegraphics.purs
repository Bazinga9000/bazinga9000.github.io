module Mines.Graphics where

import Graphics.Path2D
import Prelude

import Utils.String (unwords)


flagGraphic :: MineGraphic
flagGraphic = MinePath $ fromPathString "m970.13 169.03c-6.6562-11.812-19.125-19.031-32.625-19.031h-487.5v-37.5c0-20.719-16.781-37.5-37.5-37.5s-37.5 16.781-37.5 37.5v937.5h-112.5c-20.719 0-37.5 16.781-37.5 37.5s16.781 37.5 37.5 37.5h300c20.719 0 37.5-16.781 37.5-37.5s-16.781-37.5-37.5-37.5h-112.5v-450h487.5c13.5 0 25.969-7.2188 32.625-19.031 6.6562-11.766 6.4688-26.203-0.46875-37.781l-100.92-168.19 100.92-168.19c6.9375-11.578 7.125-26.016 0.46875-37.781z"

antiFlagGraphic :: MineGraphic
antiFlagGraphic = MinePath $ fromPathString "m366.91 871.41c4.1914 7.4375 12.043 11.984 20.547 11.984h307.01v23.617c0 13.047 10.566 23.617 23.617 23.617 13.047 0 23.617-10.566 23.617-23.617v-590.4h70.848c13.047 0 23.617-10.566 23.617-23.617 0-13.047-10.566-23.617-23.617-23.617h-188.93c-13.047 0-23.617 10.566-23.617 23.617 0 13.047 10.566 23.617 23.617 23.617h70.848v283.39h-307.01c-8.5 0-16.355 4.5469-20.547 11.984-4.1914 7.4102-4.0742 16.5 0.29688 23.793l63.559 105.92-63.559 105.92c-4.3672 7.293-4.4883 16.383-0.29688 23.793z"

genericMineGraphic :: MineGraphic
genericMineGraphic = MinePath $ fromPathString "m1164.5 564.54h-159.15c-6.9531-83.52-39.664-162.82-93.617-226.95l36.027-35.887c6.832-6.6172 10.719-15.703 10.789-25.215 0.066406-9.5117-3.6875-18.652-10.422-25.367s-15.887-10.445-25.398-10.348c-9.5078 0.09375-18.582 4.0078-25.18 10.859l-35.887 35.887c-64.133-53.953-143.43-86.668-226.95-93.617v-158.44c0-12.668-6.7578-24.375-17.73-30.711-10.969-6.332-24.488-6.332-35.461 0-10.969 6.3359-17.73 18.043-17.73 30.711v159.01c-83.25 7.1094-162.25 39.867-226.1 93.758l-35.887-35.887c-8.9961-8.7109-21.918-12.035-34-8.7422-12.082 3.293-21.531 12.715-24.859 24.789s-0.039063 25.004 8.6484 34.023l36.027 36.027v0.003906c-53.637 63.938-86.141 142.93-93.051 226.1h-159.15c-12.668 0-24.375 6.7578-30.711 17.73-6.332 10.973-6.332 24.488 0 35.461 6.3359 10.973 18.043 17.73 30.711 17.73h159.15c7.2617 83.188 39.945 162.13 93.617 226.1l-35.887 35.887c-6.6016 6.6914-10.301 15.711-10.301 25.109 0 9.3945 3.6992 18.414 10.301 25.105 6.6719 6.6328 15.699 10.359 25.105 10.359 9.4102 0 18.438-3.7266 25.109-10.359l35.887-35.887c63.969 53.672 142.91 86.355 226.1 93.617v159.15c0 12.668 6.7578 24.375 17.73 30.711 10.973 6.332 24.488 6.332 35.461 0 10.973-6.3359 17.73-18.043 17.73-30.711v-159.15c83.25-7.1094 162.25-39.867 226.1-93.758l36.027 36.027h0.003906c6.6523 6.6602 15.691 10.387 25.105 10.355 9.3789 0.058594 18.379-3.6758 24.965-10.355 6.668-6.6523 10.418-15.688 10.418-25.105 0-9.4219-3.75-18.457-10.418-25.109l-35.887-35.887c53.891-63.852 86.648-142.85 93.758-226.1h159.01c12.668 0 24.375-6.7578 30.711-17.73 6.332-10.973 6.332-24.488 0-35.461-6.3359-10.973-18.043-17.73-30.711-17.73zm-606.38-56.738c-8.7227 23.215-27.258 41.387-50.637 49.645-9.0742 3.4062-18.68 5.1836-28.371 5.25-22.57 0-44.219-8.9688-60.18-24.926-15.961-15.961-24.926-37.609-24.926-60.18 0.074219-9.6914 1.8516-19.293 5.2461-28.371 7.6406-23.695 25.414-42.766 48.512-52.055 9.7461-3.8867 20.148-5.8633 30.641-5.8164 22.57 0 44.219 8.9648 60.176 24.926 15.961 15.961 24.93 37.609 24.93 60.18 0.29297 10.75-1.5391 21.449-5.3906 31.488z"

magnetGraphic :: MineGraphic
magnetGraphic = MinePath $ fromPathString "m1141.5 590.95-145.22-145.22c-28.031-27.984-73.406-27.984-101.44 0l-48.422 48.375-290.39 290.44v0.046875c-38.906 38.344-101.48 38.156-140.16-0.46875-38.625-38.672-38.812-101.25-0.42188-140.16l338.81-338.81c27.984-28.031 27.984-73.406 0-101.44l-145.22-145.22c-28.078-27.891-73.406-27.891-101.44 0l-338.81 338.86c-112.97 113.25-156.98 278.16-115.5 432.66 41.484 154.55 162.14 275.21 316.69 316.69 154.5 41.484 319.4-2.5312 432.66-115.5l338.81-338.81h0.046875c27.938-28.031 27.938-73.406 0-101.44zm-583.18-477.1 140.58 140.63-118.69 118.64-140.58-140.58zm191.29 864.32c-94.266 94.266-231.71 131.11-360.52 96.609-128.76-34.5-229.4-135.14-263.9-263.9-34.5-128.81 2.3438-266.26 96.609-360.52l164.81-164.81 140.58 140.63-164.81 164.76c-43.969 44.062-61.125 108.23-45 168.37 16.172 60.141 63.141 107.11 123.28 123.28 60.141 16.125 124.31-1.0312 168.37-45l164.81-164.81 140.58 140.58zm217.82-217.82-140.58-140.58 118.69-118.69 140.58 140.58z"

nuclearMineGraphic :: MineGraphic 
nuclearMineGraphic = MinePath $ fromPathStrings [
    "m515.11 513.89-20.625-39.281s-206.06-220.13-247.03-263.72l-30.047 29.859 259.6 252.32z",
    "m263.95 328.22-140.29 4.125c-15.516-1.5938-31.125 22.219-41.25 30.844-10.828 11.203-10.828 29.062 0 40.078l149.16 151.5c15.516 15.703 37.547 23.016 59.156 19.453l102.98-17.109c-2.1562-36.938 0.79687-72.891 4.3125-99.422l-134.02-129.52z",
    "m557.76 390.71 16.688-104.77c3.3281-22.219-3.75-45-19.266-60.703l-149.16-151.5c-10.219-10.406-28.312-10.406-38.719 0l-22.594 23.016c-5.1094 5.2969-8.0625 12-8.0625 18.844l-3.75 143.44 127.55 135.98c22.594-3.1406 58.969-6.7031 97.266-4.3125z",
    "m1091.9 846.24c-4.7344-4.3125-9.8438-8.8594-15.141-13.734l-248.02 252.14c24.609 33.516 63.094 56.625 105.52 48.328l99.234-17.297c37.547-6.4688 67.219-36.562 73.5-74.859l17.297-101.02c5.7188-34.594-6.7031-70.547-32.438-93.562z",
    "m677.26 463.6c-35.297-41.625-135.98-49.734-191.81-41.859 0.84375 1.3125 35.203 36.703 34.219 37.312 0 0 44.016 83.906 44.016 83.906 2.9531 5.7188 1.9688 12.797-2.7656 17.297-4.4062 4.5-11.719 5.6719-17.297 2.5781 0 0-84.891-46.172-85.688-47.156l-33.234-32.016c-2.3438 24.938-3.5156 54.844-0.60938 84.516 4.7344 49.734 18.844 87.047 42.047 110.62 34.594 35.156 119.3 129.1 252.32 280.03l234.66-238.6c-109.08-99.047-233.48-213.42-275.9-256.64z",
    "m974.95 740.11-237 240.94c22.406 25.547 46.172 52.688 71.344 81.375l245.68-249.79c-23.578-21.234-50.906-46.172-79.969-72.516z"
]

bannerGraphic :: MineGraphic 
bannerGraphic = MinePath $ fromPathString "m995.76 94.219h-343.69v41.297h343.74v0.09375c19.266 0.046875 11.625 27.047 51.984 27.047 10.828 0 23.391-6.0938 33.141-15.844l0.046875 0.046875c48.844-48.891-38.016-112.45-71.531-60.422-2.7656 4.6406-7.8281 7.7812-13.688 7.7812zm-447.89 0h-343.74v-0.046875c-19.266-0.046875-11.625-27-51.984-27-29.156 0-69.75 43.031-33.141 79.594 22.219 22.219 55.453 21.562 71.531-3.375 2.7188-4.7344 7.8281-7.875 13.641-7.875h343.74zm31.453-15.703v125.53h41.297v-144.05h-41.297zm41.297 870.79c-22.078 11.156-17.953 11.766-41.297 0v190.69h41.297zm-284.72-745.26v-37.078h211.97v37.078zm528.14-37.078h-211.97v37.078h211.97zm-599.95 658.64 153-77.391c4.3125-2.1562 9.5156-2.3438 14.156 0l168.74 85.359 168.71-85.312c4.3125-2.1562 9.5156-2.3438 14.156 0l153 77.344v-590.16h-671.76zm671.76 35.156v55.875l-153.05-77.391c-4.6406-2.3438-9.8438-2.1562-14.156 0l-168.71 87.797-168.74-87.844c-4.6406-2.3438-9.8438-2.1562-14.156 0l-153 77.391 0.046875-55.828 160.08-80.953 168.71 85.312c4.3125 2.1562 9.5156 2.3438 14.156 0l168.74-85.359zm-304.26-401.39c2.3906 5.0625 7.125 8.2969 12.281 8.9062v0.046876l73.641 9.2812-54.188 50.812c-4.0781 3.7969-5.625 9.2812-4.6406 14.391l13.969 72.984-65.109-35.859c-4.9219-2.7188-10.641-2.4844-15.234 0.046876l-64.969 35.766 13.969-72.984c1.0781-5.7188-1.0781-11.25-5.1562-14.812l-53.719-50.391 73.641-9.2812c6.0469-0.75 10.875-4.8281 12.844-10.172l31.078-66.094zm-6.1875-86.812 30.844 65.672 72.891 9.1875c23.531 2.9531 32.484 31.828 15.562 47.719l-53.625 50.297 13.828 72.188c4.4062 23.016-20.016 40.828-40.594 29.484l-64.359-35.438-64.359 35.438c-15.844 8.7188-34.547-0.375-39.141-14.109l-0.046875 0.046876c-1.875-4.7812-2.3906-10.078-1.3594-15.422l13.828-72.188-53.625-50.297c-16.922-15.891-7.9219-44.766 15.562-47.719l72.891-9.1875 31.219-66.469h-0.046875c10.5-22.312 41.906-20.438 50.531 0.79687zm125.34-7.9688c83.25 83.25 83.25 218.29 0 301.6-133.97 133.97-364.03 38.625-364.03-150.79 0-189.42 230.06-284.76 364.03-150.79zm-150.79-93.938c217.26 0 326.81 263.95 173.02 417.71-153.79 153.79-417.71 44.25-417.71-173.02 0-135.1 109.55-244.69 244.69-244.69z"

antiBannerGraphic :: MineGraphic
antiBannerGraphic = MinePath $ fromPathString "m350.77 918.52h216.45v-26.008h-216.47v-0.058594c-12.133-0.03125-7.3203-17.031-32.738-17.031-6.8203 0-14.73 3.8359-20.871 9.9766l-0.03125-0.03125c-30.762 30.789 23.941 70.82 45.047 38.051 1.7422-2.9219 4.9297-4.8984 8.6211-4.8984zm282.06 0h216.47v0.03125c12.133 0.03125 7.3203 17.004 32.738 17.004 18.363 0 43.926-27.098 20.871-50.125-13.992-13.992-34.922-13.578-45.047 2.125-1.7109 2.9805-4.9297 4.9609-8.5898 4.9609h-216.47zm-19.809 9.8906v-79.055h-26.008v90.715h26.008zm-26.008-548.39c13.902-7.0273 11.305-7.4102 26.008 0v-120.09h-26.008zm179.31 469.34v23.352h-133.49v-23.352zm-332.61 23.352h133.49v-23.352h-133.49zm377.83-414.79-96.355 48.738c-2.7148 1.3594-5.9922 1.4766-8.9141 0l-106.27-53.758-106.25 53.727c-2.7148 1.3594-5.9922 1.4766-8.9141 0l-96.355-48.707v371.66h423.05zm-423.05-22.141v-35.188l96.383 48.738c2.9219 1.4766 6.1992 1.3594 8.9141 0l106.25-55.293 106.27 55.32c2.9219 1.4766 6.1992 1.3594 8.9141 0l96.355-48.738-0.03125 35.156-100.81 50.98-106.25-53.727c-2.7148-1.3594-5.9922-1.4766-8.9141 0l-106.27 53.758zm191.61 252.78c-1.5039-3.1875-4.4883-5.2266-7.7344-5.6094v-0.03125l-46.375-5.8438 34.125-32c2.5664-2.3906 3.543-5.8438 2.9219-9.0625l-8.7969-45.961 41.004 22.582c3.1016 1.7109 6.6992 1.5664 9.5938-0.03125l40.914-22.523-8.7969 45.961c-0.67969 3.6016 0.67969 7.0859 3.2461 9.3281l33.832 31.734-46.375 5.8438c-3.8086 0.47266-6.8477 3.0391-8.0898 6.4062l-19.57 41.625zm3.8984 54.672-19.426-41.359-45.902-5.7852c-14.82-1.8594-20.457-20.043-9.8008-30.051l33.77-31.676-8.707-45.461c-2.7734-14.496 12.605-25.711 25.562-18.566l40.531 22.316 40.531-22.316c9.9766-5.4922 21.758 0.23438 24.648 8.8867l0.03125-0.03125c1.1797 3.0117 1.5039 6.3477 0.85547 9.7109l-8.707 45.461 33.77 31.676c10.656 10.008 4.9883 28.191-9.8008 30.051l-45.902 5.7852-19.66 41.859h0.03125c-6.6133 14.051-26.391 12.871-31.824-0.5zm-78.934 5.0195c-52.426-52.426-52.426-137.47 0-189.93 84.367-84.367 229.25-24.324 229.25 94.965 0 119.29-144.89 179.33-229.25 94.965zm94.965 59.156c-136.82 0-205.81-166.23-108.96-263.05 96.852-96.852 263.05-27.867 263.05 108.96 0 85.078-68.988 154.1-154.1 154.1z"

misflagX :: Path2D
misflagX = fromPathString "m626.44 600 310.69-310.69c7.3125-7.3125 7.3125-19.125 0-26.438s-19.125-7.3125-26.438 0l-310.69 310.69-310.69-310.69c-7.3125-7.3125-19.125-7.3125-26.438 0s-7.3125 19.125 0 26.438l310.69 310.69-310.69 310.69c-7.3125 7.3125-7.3125 19.125 0 26.438 3.75 3.75 8.4375 5.4375 13.312 5.4375s9.5625-1.875 13.312-5.4375l310.5-310.69 310.69 310.69c3.75 3.75 8.4375 5.4375 13.312 5.4375s9.5625-1.875 13.312-5.4375c7.3125-7.3125 7.3125-19.125 0-26.438z"

data MineGraphic = MineSymbol String | MinePath Path2D
type MineGraphics = {
    mineGraphic :: MineGraphic,
    mineColor :: String,
    flagGraphic :: MineGraphic,
    flagColor :: String
}

fromSymbol :: String -> MineGraphics 
fromSymbol s = {
    mineGraphic: MineSymbol s, 
    mineColor: "#000000",
    flagGraphic: MineSymbol s, 
    flagColor: "#600000" 
}

standardMineGraphics :: MineGraphics 
standardMineGraphics = {
    mineGraphic: genericMineGraphic,
    mineColor: "#000000",
    flagGraphic: flagGraphic,
    flagColor: "#000000"
}

antiMineGraphics :: MineGraphics 
antiMineGraphics = {
    mineGraphic: genericMineGraphic,
    mineColor: "#ffffff",
    flagGraphic: antiFlagGraphic,
    flagColor: "#ffffff"
}

redMineGraphics :: MineGraphics 
redMineGraphics = {
    mineGraphic: genericMineGraphic,
    mineColor: "#cc0000",
    flagGraphic: flagGraphic,
    flagColor: "#b20000"
}

greenMineGraphics :: MineGraphics 
greenMineGraphics = {
    mineGraphic: genericMineGraphic,
    mineColor: "#00cc00",
    flagGraphic: flagGraphic,
    flagColor: "#00b200"
}

blueMineGraphics :: MineGraphics 
blueMineGraphics = {
    mineGraphic: genericMineGraphic,
    mineColor: "#0000cc",
    flagGraphic: flagGraphic,
    flagColor: "#0000b2"
}

antiRedMineGraphics :: MineGraphics
antiRedMineGraphics = {
    mineGraphic: genericMineGraphic,
    mineColor: "#00cccc",
    flagGraphic: antiFlagGraphic,
    flagColor: "#00b2b2"
}

antiGreenMineGraphics :: MineGraphics
antiGreenMineGraphics = {
    mineGraphic: genericMineGraphic,
    mineColor: "#cc00cc",
    flagGraphic: antiFlagGraphic,
    flagColor: "#b200b2"
}

antiBlueMineGraphics :: MineGraphics
antiBlueMineGraphics = {
    mineGraphic: genericMineGraphic,
    mineColor: "#cccc00",
    flagGraphic: antiFlagGraphic,
    flagColor: "#b2b200"
}

magnetMineGraphics :: MineGraphics 
magnetMineGraphics = {
    mineGraphic: magnetGraphic,
    mineColor: "#000000",
    flagGraphic: magnetGraphic,
    flagColor: "#660000"
}

largeMineGraphics :: MineGraphics 
largeMineGraphics = {
    mineGraphic: nuclearMineGraphic,
    mineColor: "#000000",
    flagGraphic: bannerGraphic,
    flagColor: "#000000"
}

largeAntiMineGraphics :: MineGraphics 
largeAntiMineGraphics = {
    mineGraphic: nuclearMineGraphic,
    mineColor: "#ffffff",
    flagGraphic: antiBannerGraphic,
    flagColor: "#ffffff"
}

largeRedMineGraphics :: MineGraphics 
largeRedMineGraphics = {
    mineGraphic: nuclearMineGraphic,
    mineColor: "#cc0000",
    flagGraphic: bannerGraphic,
    flagColor: "#b20000"
}

largeGreenMineGraphics :: MineGraphics 
largeGreenMineGraphics = {
    mineGraphic: nuclearMineGraphic,
    mineColor: "#00cc00",
    flagGraphic: bannerGraphic,
    flagColor: "#00b200"
}

largeBlueMineGraphics :: MineGraphics 
largeBlueMineGraphics = {
    mineGraphic: nuclearMineGraphic,
    mineColor: "#0000cc",
    flagGraphic: bannerGraphic,
    flagColor: "#0000b2"
}

largeAntiRedMineGraphics :: MineGraphics 
largeAntiRedMineGraphics = {
    mineGraphic: nuclearMineGraphic,
    mineColor: "#00cccc",
    flagGraphic: antiBannerGraphic,
    flagColor: "#00b2b2"
}

largeAntiGreenMineGraphics :: MineGraphics 
largeAntiGreenMineGraphics = {
    mineGraphic: nuclearMineGraphic,
    mineColor: "#cc00cc",
    flagGraphic: antiBannerGraphic,
    flagColor: "#b200b2"
}

largeAntiBlueMineGraphics :: MineGraphics 
largeAntiBlueMineGraphics = {
    mineGraphic: nuclearMineGraphic,
    mineColor: "#cccc00",
    flagGraphic: antiBannerGraphic,
    flagColor: "#b2b200"
}