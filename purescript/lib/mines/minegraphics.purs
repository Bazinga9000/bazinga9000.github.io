module Mines.Graphics where

import Graphics.Path2D
import Prelude

import Utils.String (unwords)


flagGraphic :: MineGraphic
flagGraphic = MinePath $ fromPathString "m970.13 169.03c-6.6562-11.812-19.125-19.031-32.625-19.031h-487.5v-37.5c0-20.719-16.781-37.5-37.5-37.5s-37.5 16.781-37.5 37.5v937.5h-112.5c-20.719 0-37.5 16.781-37.5 37.5s16.781 37.5 37.5 37.5h300c20.719 0 37.5-16.781 37.5-37.5s-16.781-37.5-37.5-37.5h-112.5v-450h487.5c13.5 0 25.969-7.2188 32.625-19.031 6.6562-11.766 6.4688-26.203-0.46875-37.781l-100.92-168.19 100.92-168.19c6.9375-11.578 7.125-26.016 0.46875-37.781z"

antiFlagGraphic :: MineGraphic
antiFlagGraphic = MinePath $ fromPathString "m366.91 871.41c4.1914 7.4375 12.043 11.984 20.547 11.984h307.01v23.617c0 13.047 10.566 23.617 23.617 23.617 13.047 0 23.617-10.566 23.617-23.617v-590.4h70.848c13.047 0 23.617-10.566 23.617-23.617 0-13.047-10.566-23.617-23.617-23.617h-188.93c-13.047 0-23.617 10.566-23.617 23.617 0 13.047 10.566 23.617 23.617 23.617h70.848v283.39h-307.01c-8.5 0-16.355 4.5469-20.547 11.984-4.1914 7.4102-4.0742 16.5 0.29688 23.793l63.559 105.92-63.559 105.92c-4.3672 7.293-4.4883 16.383-0.29688 23.793z"

genericMineGraphic :: MineGraphic
genericMineGraphic = MinePath $ fromPathString "m1164.5 564.54h-159.15c-6.9531-83.52-39.664-162.82-93.617-226.95l36.027-35.887c6.832-6.6172 10.719-15.703 10.789-25.215 0.066406-9.5117-3.6875-18.652-10.422-25.367s-15.887-10.445-25.398-10.348c-9.5078 0.09375-18.582 4.0078-25.18 10.859l-35.887 35.887c-64.133-53.953-143.43-86.668-226.95-93.617v-158.44c0-12.668-6.7578-24.375-17.73-30.711-10.969-6.332-24.488-6.332-35.461 0-10.969 6.3359-17.73 18.043-17.73 30.711v159.01c-83.25 7.1094-162.25 39.867-226.1 93.758l-35.887-35.887c-8.9961-8.7109-21.918-12.035-34-8.7422-12.082 3.293-21.531 12.715-24.859 24.789s-0.039063 25.004 8.6484 34.023l36.027 36.027v0.003906c-53.637 63.938-86.141 142.93-93.051 226.1h-159.15c-12.668 0-24.375 6.7578-30.711 17.73-6.332 10.973-6.332 24.488 0 35.461 6.3359 10.973 18.043 17.73 30.711 17.73h159.15c7.2617 83.188 39.945 162.13 93.617 226.1l-35.887 35.887c-6.6016 6.6914-10.301 15.711-10.301 25.109 0 9.3945 3.6992 18.414 10.301 25.105 6.6719 6.6328 15.699 10.359 25.105 10.359 9.4102 0 18.438-3.7266 25.109-10.359l35.887-35.887c63.969 53.672 142.91 86.355 226.1 93.617v159.15c0 12.668 6.7578 24.375 17.73 30.711 10.973 6.332 24.488 6.332 35.461 0 10.973-6.3359 17.73-18.043 17.73-30.711v-159.15c83.25-7.1094 162.25-39.867 226.1-93.758l36.027 36.027h0.003906c6.6523 6.6602 15.691 10.387 25.105 10.355 9.3789 0.058594 18.379-3.6758 24.965-10.355 6.668-6.6523 10.418-15.688 10.418-25.105 0-9.4219-3.75-18.457-10.418-25.109l-35.887-35.887c53.891-63.852 86.648-142.85 93.758-226.1h159.01c12.668 0 24.375-6.7578 30.711-17.73 6.332-10.973 6.332-24.488 0-35.461-6.3359-10.973-18.043-17.73-30.711-17.73zm-606.38-56.738c-8.7227 23.215-27.258 41.387-50.637 49.645-9.0742 3.4062-18.68 5.1836-28.371 5.25-22.57 0-44.219-8.9688-60.18-24.926-15.961-15.961-24.926-37.609-24.926-60.18 0.074219-9.6914 1.8516-19.293 5.2461-28.371 7.6406-23.695 25.414-42.766 48.512-52.055 9.7461-3.8867 20.148-5.8633 30.641-5.8164 22.57 0 44.219 8.9648 60.176 24.926 15.961 15.961 24.93 37.609 24.93 60.18 0.29297 10.75-1.5391 21.449-5.3906 31.488z"

magnetGraphic :: MineGraphic
magnetGraphic = MinePath $ fromPathString "m1141.5 590.95-145.22-145.22c-28.031-27.984-73.406-27.984-101.44 0l-48.422 48.375-290.39 290.44v0.046875c-38.906 38.344-101.48 38.156-140.16-0.46875-38.625-38.672-38.812-101.25-0.42188-140.16l338.81-338.81c27.984-28.031 27.984-73.406 0-101.44l-145.22-145.22c-28.078-27.891-73.406-27.891-101.44 0l-338.81 338.86c-112.97 113.25-156.98 278.16-115.5 432.66 41.484 154.55 162.14 275.21 316.69 316.69 154.5 41.484 319.4-2.5312 432.66-115.5l338.81-338.81h0.046875c27.938-28.031 27.938-73.406 0-101.44zm-583.18-477.1 140.58 140.63-118.69 118.64-140.58-140.58zm191.29 864.32c-94.266 94.266-231.71 131.11-360.52 96.609-128.76-34.5-229.4-135.14-263.9-263.9-34.5-128.81 2.3438-266.26 96.609-360.52l164.81-164.81 140.58 140.63-164.81 164.76c-43.969 44.062-61.125 108.23-45 168.37 16.172 60.141 63.141 107.11 123.28 123.28 60.141 16.125 124.31-1.0312 168.37-45l164.81-164.81 140.58 140.58zm217.82-217.82-140.58-140.58 118.69-118.69 140.58 140.58z"
misflagX :: Path2D
misflagX = fromPathString "m626.44 600 310.69-310.69c7.3125-7.3125 7.3125-19.125 0-26.438s-19.125-7.3125-26.438 0l-310.69 310.69-310.69-310.69c-7.3125-7.3125-19.125-7.3125-26.438 0s-7.3125 19.125 0 26.438l310.69 310.69-310.69 310.69c-7.3125 7.3125-7.3125 19.125 0 26.438 3.75 3.75 8.4375 5.4375 13.312 5.4375s9.5625-1.875 13.312-5.4375l310.5-310.69 310.69 310.69c3.75 3.75 8.4375 5.4375 13.312 5.4375s9.5625-1.875 13.312-5.4375c7.3125-7.3125 7.3125-19.125 0-26.438z"

data MineGraphic = MineSymbol String | MinePath Path2D
type MineGraphics = {
    mineGraphic :: MineGraphic,
    mineColor :: String,
    flagGraphic :: MineGraphic,
    flagColor :: String
}

fromSymbol :: String -> MineGraphics 
fromSymbol s = {
    mineGraphic: MineSymbol s, 
    mineColor: "#000000",
    flagGraphic: MineSymbol s, 
    flagColor: "#600000" 
}

standardMineGraphics :: MineGraphics 
standardMineGraphics = {
    mineGraphic: genericMineGraphic,
    mineColor: "#000000",
    flagGraphic: flagGraphic,
    flagColor: "#000000"
}

antiMineGraphics :: MineGraphics 
antiMineGraphics = {
    mineGraphic: genericMineGraphic,
    mineColor: "#ffffff",
    flagGraphic: antiFlagGraphic,
    flagColor: "#ffffff"
}

redMineGraphics :: MineGraphics 
redMineGraphics = {
    mineGraphic: genericMineGraphic,
    mineColor: "#cc0000",
    flagGraphic: flagGraphic,
    flagColor: "#b20000"
}

greenMineGraphics :: MineGraphics 
greenMineGraphics = {
    mineGraphic: genericMineGraphic,
    mineColor: "#00cc00",
    flagGraphic: flagGraphic,
    flagColor: "#00b200"
}

blueMineGraphics :: MineGraphics 
blueMineGraphics = {
    mineGraphic: genericMineGraphic,
    mineColor: "#0000cc",
    flagGraphic: flagGraphic,
    flagColor: "#0000b2"
}

antiRedMineGraphics :: MineGraphics
antiRedMineGraphics = {
    mineGraphic: genericMineGraphic,
    mineColor: "#00cccc",
    flagGraphic: antiFlagGraphic,
    flagColor: "#00b2b2"
}

antiGreenMineGraphics :: MineGraphics
antiGreenMineGraphics = {
    mineGraphic: genericMineGraphic,
    mineColor: "#cc00cc",
    flagGraphic: antiFlagGraphic,
    flagColor: "#b200b2"
}

antiBlueMineGraphics :: MineGraphics
antiBlueMineGraphics = {
    mineGraphic: genericMineGraphic,
    mineColor: "#cccc00",
    flagGraphic: antiFlagGraphic,
    flagColor: "#b2b200"
}

magnetMineGraphics :: MineGraphics 
magnetMineGraphics = {
    mineGraphic: magnetGraphic,
    mineColor: "#000000",
    flagGraphic: magnetGraphic,
    flagColor: "#660000"
}